---
name: setup
description: Interactive setup for human voice configuration
argument-hint: ""
allowed-tools:
  - Read
  - Write
  - Glob
  - Bash
  - AskUserQuestion
---

# Human Voice Setup

Interactive configuration wizard for setting up AI pattern detection in the current project.

## Process

1. **Check for existing configuration**
2. **Detect project structure** and content directories
3. **Gather preferences** through interactive questions
4. **Create configuration file** (`.claude/human-voice.local.md`)
5. **Run initial scan** (optional)

## Existing Configuration Check

Check for:
- `.claude/human-voice.local.md` - Plugin configuration
- Content directories (`_posts`, `content`, `docs`, `_docs`)
- Markdown/text files in project

If configuration exists:
- Read current configuration using Read tool
- Ask: "Configuration already exists. Update existing or replace?"

## Detect Project Structure

Analyze project to suggest smart defaults:

**Content Directories**
- Check for `docs/` directory
- Check for `_posts/` (Jekyll)
- Check for `content/` (Hugo, Gatsby)
- Check for `_docs/` or `pages/`
- Find any `.md` or `.mdx` files

**Static Site Generator**
- Look for `_config.yml` -> Jekyll
- Look for `config.toml` or `hugo.toml` -> Hugo
- Look for `gatsby-config.js` -> Gatsby
- Look for `docusaurus.config.js` -> Docusaurus
- Look for `mkdocs.yml` -> MkDocs

**Ignore Patterns**
- Detect `node_modules/`, `vendor/`, etc.
- Find build output directories
- Identify generated files (CHANGELOG.md, LICENSE)

## Configuration Questions

Use AskUserQuestion for structured input:

### Content Scope
"Which directories contain content to review?"
- [Detected directories]
- All markdown files
- Custom paths

### File Extensions
"Which file types should be scanned?"
- .md and .mdx (recommended)
- Include .txt
- Include .rst (reStructuredText)
- Custom extensions

### Detection Tiers
"Which detection tiers should be enabled?"
- All tiers (recommended)
- Character patterns only (fastest)
- Character + Language patterns
- Custom selection

### Character Pattern Settings
"How should character patterns be handled?"
- Fix automatically (recommended)
- Report only
- Ignore specific patterns

### Strictness Level
"How strict should the voice review be?"
- Strict: Flag all AI patterns
- Normal: Flag common patterns (recommended)
- Lenient: Flag only obvious patterns

### Dry Run Default
"Should fixes preview changes first?"
- Yes, always preview (recommended)
- No, apply directly

## Create Configuration

Generate `.claude/human-voice.local.md` based on responses:

```markdown
---
# Human Voice Plugin Configuration
# Generated by /human-voice:setup on [date]

extensions:
  [selected extensions]

content_directories:
  [detected or user-specified paths]

ignore:
  [detected or user-specified patterns]

detection:
  character_patterns:
    enabled: [true/false]
    [pattern settings]

  language_patterns:
    enabled: [true/false]

  structural_patterns:
    enabled: [true/false]

  voice_patterns:
    enabled: [true/false]

fix:
  dry_run_by_default: [true/false]
  report_format: [level]

output:
  verbosity: [level]
  format: markdown
---

# Project Voice Notes

[Project name] Voice Guidelines

## Voice Guidelines

- [User can add project-specific context here]

## Exceptions

- [Acceptable patterns for this project]
```

## Create Directory

Use Bash tool to create the `.claude/` directory if it doesn't exist:
```bash
mkdir -p .claude
```

## Write Configuration

Use Write tool to create the configuration file at `.claude/human-voice.local.md`.

## Initial Scan (Optional)

"Would you like to run an initial scan of your content?"

If yes:
- Run `/human-voice:review` on detected content directories
- Report summary of findings
- Suggest running `/human-voice:fix` if character issues found

## Output

```markdown
## Human Voice Setup Complete

**Configuration file:** .claude/human-voice.local.md

### Detected Settings
- Content directories: [list]
- File extensions: [list]
- Ignore patterns: [list]
- Site generator: [type or none]

### Detection Configuration
- Character patterns: [enabled/disabled]
- Language patterns: [enabled/disabled]
- Structural patterns: [enabled/disabled]
- Voice patterns: [enabled/disabled]

### Fix Settings
- Dry run default: [yes/no]
- Report format: [level]

### Next Steps
1. Review the configuration file
2. Add project-specific voice notes to the markdown section
3. Run `/human-voice:review` to scan content
4. Run `/human-voice:fix` to auto-fix character issues
5. Adjust settings as needed

### Manual Editing

Edit `.claude/human-voice.local.md` directly to:
- Add custom ignore patterns
- Adjust detection sensitivity
- Add project-specific voice guidelines
- Document acceptable exceptions
```

## Memory Integration (Optional)

If Subcog MCP tools are available:

**Before setup:** Recall any existing voice configuration decisions for this project.

**After setup:** Capture the configuration decision for future reference, including which directories and settings were chosen.

This integration is optional. Setup works fully without Subcog - configuration is always stored in `.claude/human-voice.local.md`.

## Template Reference

The example configuration template is available at:
`${CLAUDE_PLUGIN_ROOT}/templates/human-voice.local.md.example`
